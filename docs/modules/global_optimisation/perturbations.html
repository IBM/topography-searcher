<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Perturbations &mdash; topsearch 0.0.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=47de8214"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            topsearch
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">topsearch</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Perturbations</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/modules/global_optimisation/perturbations.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-topsearch.global_optimisation.perturbations">
<span id="perturbations"></span><h1>Perturbations<a class="headerlink" href="#module-topsearch.global_optimisation.perturbations" title="Link to this heading"></a></h1>
<p>Perturbations module contains classes that take steps around
a given space. The perturbations have a separate class for each
coordinates class, as molecular and atomistic systems require
different changes that respect the bonding framework. These instances are
passed to the global optimisation instance to drive its step-taking</p>
<dl class="py class">
<dt class="sig sig-object py" id="topsearch.global_optimisation.perturbations.AtomicPerturbation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">topsearch.global_optimisation.perturbations.</span></span><span class="sig-name descname"><span class="pre">AtomicPerturbation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_displacement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topsearch.global_optimisation.perturbations.AtomicPerturbation" title="Link to this definition"></a></dt>
<dd><section id="description">
<h2>Description<a class="headerlink" href="#description" title="Link to this heading"></a></h2>
<p>Simple displacement routine applicable to atomic systems. Applies
a 3D displacement vector to selected atoms.
Perturbs up to max_atoms atoms with a displacement up to max_displacement</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="topsearch.global_optimisation.perturbations.AtomicPerturbation.max_displacement">
<span class="sig-name descname"><span class="pre">max_displacement</span></span><a class="headerlink" href="#topsearch.global_optimisation.perturbations.AtomicPerturbation.max_displacement" title="Link to this definition"></a></dt>
<dd><p>The maximum allowed displacement in a given direction for an atom</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="topsearch.global_optimisation.perturbations.AtomicPerturbation.max_atoms">
<span class="sig-name descname"><span class="pre">max_atoms</span></span><a class="headerlink" href="#topsearch.global_optimisation.perturbations.AtomicPerturbation.max_atoms" title="Link to this definition"></a></dt>
<dd><p>The maximum number of atoms that can be perturbed at each call</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.global_optimisation.perturbations.AtomicPerturbation.perturb">
<span class="sig-name descname"><span class="pre">perturb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">type</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#topsearch.global_optimisation.perturbations.AtomicPerturbation.perturb" title="Link to this definition"></a></dt>
<dd><p>Returns coords perturbed by a displacement to up to max_atoms</p>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="topsearch.global_optimisation.perturbations.MolecularPerturbation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">topsearch.global_optimisation.perturbations.</span></span><span class="sig-name descname"><span class="pre">MolecularPerturbation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_displacement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bonds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topsearch.global_optimisation.perturbations.MolecularPerturbation" title="Link to this definition"></a></dt>
<dd><section id="id1">
<h2>Description<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<p>Displacement routine applicable to molecular systems. Needs to retain the
bonding framework, which it achieves through rotation of bond dihedrals.
Selects a random subset of flexible bond dihedrals and rotates through a
random angle up to a specified limit</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="topsearch.global_optimisation.perturbations.MolecularPerturbation.max_displacement">
<span class="sig-name descname"><span class="pre">max_displacement</span></span><a class="headerlink" href="#topsearch.global_optimisation.perturbations.MolecularPerturbation.max_displacement" title="Link to this definition"></a></dt>
<dd><p>The maximum allowed angle change of a given dihedral</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="topsearch.global_optimisation.perturbations.MolecularPerturbation.max_bonds">
<span class="sig-name descname"><span class="pre">max_bonds</span></span><a class="headerlink" href="#topsearch.global_optimisation.perturbations.MolecularPerturbation.max_bonds" title="Link to this definition"></a></dt>
<dd><p>The maximum number of dihedrals that can be perturbed at each call</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.global_optimisation.perturbations.MolecularPerturbation.perturb">
<span class="sig-name descname"><span class="pre">perturb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">type</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#topsearch.global_optimisation.perturbations.MolecularPerturbation.perturb" title="Link to this definition"></a></dt>
<dd><p>Rotate about randomly selected bonds within a molecular system</p>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="topsearch.global_optimisation.perturbations.StandardPerturbation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">topsearch.global_optimisation.perturbations.</span></span><span class="sig-name descname"><span class="pre">StandardPerturbation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_displacement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proportional_distance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topsearch.global_optimisation.perturbations.StandardPerturbation" title="Link to this definition"></a></dt>
<dd><section id="id2">
<h2>Description<a class="headerlink" href="#id2" title="Link to this heading"></a></h2>
<p>Class to perturb a position in Euclidean space for use in global
optimisation. For non-atomic systems this is implemented as
random displacements</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="topsearch.global_optimisation.perturbations.StandardPerturbation.max_displacement">
<span class="sig-name descname"><span class="pre">max_displacement</span></span><a class="headerlink" href="#topsearch.global_optimisation.perturbations.StandardPerturbation.max_displacement" title="Link to this definition"></a></dt>
<dd><p>Maximum allowed perturbation size from the given point</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="topsearch.global_optimisation.perturbations.StandardPerturbation.proportional_distance">
<span class="sig-name descname"><span class="pre">proportional_distance</span></span><a class="headerlink" href="#topsearch.global_optimisation.perturbations.StandardPerturbation.proportional_distance" title="Link to this definition"></a></dt>
<dd><p>Determines whether max_displacement is an absolute value (if False)
or a proportion of the bounds (if True)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>logical</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.global_optimisation.perturbations.StandardPerturbation.perturb">
<span class="sig-name descname"><span class="pre">perturb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">type</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#topsearch.global_optimisation.perturbations.StandardPerturbation.perturb" title="Link to this definition"></a></dt>
<dd><p>Displace the given position by randomly up to specified size</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.global_optimisation.perturbations.StandardPerturbation.set_step_sizes">
<span class="sig-name descname"><span class="pre">set_step_sizes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">type</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">NDArray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#topsearch.global_optimisation.perturbations.StandardPerturbation.set_step_sizes" title="Link to this definition"></a></dt>
<dd><p>Generate an appropriate step size for the given coordinates</p>
</dd></dl>

</section>
</dd></dl>

</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Luke Dicks.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>