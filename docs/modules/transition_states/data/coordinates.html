<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Coordinates &mdash; topsearch 0.0.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=47de8214"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            topsearch
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">topsearch</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Coordinates</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/modules/data/coordinates.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-topsearch.data.coordinates">
<span id="coordinates"></span><h1>Coordinates<a class="headerlink" href="#module-topsearch.data.coordinates" title="Link to this heading"></a></h1>
<p>Module containing the different coordinates classes that are
used to store and modify positions in space. These can be separated
into StandardCoordinates, which is used for ML models, AtomicCoordinates
which is used for clusters of atoms, and MolecularCoordinates that stores
molecular configurations.</p>
<dl class="py class">
<dt class="sig sig-object py" id="topsearch.data.coordinates.AtomicCoordinates">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">topsearch.data.coordinates.</span></span><span class="sig-name descname"><span class="pre">AtomicCoordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">NDArray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topsearch.data.coordinates.AtomicCoordinates" title="Link to this definition"></a></dt>
<dd><section id="description">
<h2>Description<a class="headerlink" href="#description" title="Link to this heading"></a></h2>
<p>Class to store the coordinates of an atomic system in Euclidean space.
Methods to check configurations, modify atomic positions and
write configurations to file</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="topsearch.data.coordinates.AtomicCoordinates.bounds">
<span class="sig-name descname"><span class="pre">bounds</span></span><a class="headerlink" href="#topsearch.data.coordinates.AtomicCoordinates.bounds" title="Link to this definition"></a></dt>
<dd><p>The allowed ranges of the coordinates in each dimension</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of tuples [(b1_min, b1_max), (b2_min, b2_max)…]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="topsearch.data.coordinates.AtomicCoordinates.ndim">
<span class="sig-name descname"><span class="pre">ndim</span></span><a class="headerlink" href="#topsearch.data.coordinates.AtomicCoordinates.ndim" title="Link to this definition"></a></dt>
<dd><p>The dimensionality of the coordinates, 3*n_atoms</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="topsearch.data.coordinates.AtomicCoordinates.position">
<span class="sig-name descname"><span class="pre">position</span></span><a class="headerlink" href="#topsearch.data.coordinates.AtomicCoordinates.position" title="Link to this definition"></a></dt>
<dd><p>Array of size ndim containing the current position
(x1, y1, z1), …, (x_n, y_n, z_n)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="topsearch.data.coordinates.AtomicCoordinates.atom_labels">
<span class="sig-name descname"><span class="pre">atom_labels</span></span><a class="headerlink" href="#topsearch.data.coordinates.AtomicCoordinates.atom_labels" title="Link to this definition"></a></dt>
<dd><p>The species in the system, matching the order of position</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.AtomicCoordinates.check_atom_clashes">
<span class="sig-name descname"><span class="pre">check_atom_clashes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.AtomicCoordinates.check_atom_clashes" title="Link to this definition"></a></dt>
<dd><p>Determine if there are atom clashes within the configuration</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.AtomicCoordinates.get_atom">
<span class="sig-name descname"><span class="pre">get_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_ind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">NDArray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#topsearch.data.coordinates.AtomicCoordinates.get_atom" title="Link to this definition"></a></dt>
<dd><p>Get the Cartesian position of the atom given index atom_ind</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.AtomicCoordinates.get_connected_atoms">
<span class="sig-name descname"><span class="pre">get_connected_atoms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.AtomicCoordinates.get_connected_atoms" title="Link to this definition"></a></dt>
<dd><p>Get the connected atom labels of each atom in cluster</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.AtomicCoordinates.remove_atom_clashes">
<span class="sig-name descname"><span class="pre">remove_atom_clashes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#topsearch.data.coordinates.AtomicCoordinates.remove_atom_clashes" title="Link to this definition"></a></dt>
<dd><p>Routine to remove clashes between atoms that result in
very large gradient values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.AtomicCoordinates.same_bonds">
<span class="sig-name descname"><span class="pre">same_bonds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.AtomicCoordinates.same_bonds" title="Link to this definition"></a></dt>
<dd><p>Check if we still have a connected network of atoms</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.AtomicCoordinates.write_extended_xyz">
<span class="sig-name descname"><span class="pre">write_extended_xyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">NDArray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.AtomicCoordinates.write_extended_xyz" title="Link to this definition"></a></dt>
<dd><p>Dump an extended xyz file for visualisation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.AtomicCoordinates.write_xyz">
<span class="sig-name descname"><span class="pre">write_xyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.AtomicCoordinates.write_xyz" title="Link to this definition"></a></dt>
<dd><p>Dump an xyz file for visualisation</p>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">topsearch.data.coordinates.</span></span><span class="sig-name descname"><span class="pre">MolecularCoordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">NDArray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates" title="Link to this definition"></a></dt>
<dd><section id="id1">
<h2>Description<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<p>Class to store the coordinates of a molecular system, and
methods to modify molecular conformations and write out configurations.
Inherits from AtomicCoordinates, but contains additional functionality
to generate internal coordinate representation and check bonding structure.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.bounds">
<span class="sig-name descname"><span class="pre">bounds</span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.bounds" title="Link to this definition"></a></dt>
<dd><p>The allowed ranges of the coordinates in each dimension</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of tuples [(b1_min, b1_max), (b2_min, b2_max)…]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.ndim">
<span class="sig-name descname"><span class="pre">ndim</span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.ndim" title="Link to this definition"></a></dt>
<dd><p>The dimensionality of the coordinates, 3*n_atoms</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.position">
<span class="sig-name descname"><span class="pre">position</span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.position" title="Link to this definition"></a></dt>
<dd><p>Array of size ndim containing the current position</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.atom_labels">
<span class="sig-name descname"><span class="pre">atom_labels</span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.atom_labels" title="Link to this definition"></a></dt>
<dd><p>The species in the system, matching the order of position</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.change_bond_angles">
<span class="sig-name descname"><span class="pre">change_bond_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_network</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.change_bond_angles" title="Link to this definition"></a></dt>
<dd><p>Given a list of bond angles, update them by all by step</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.change_bond_length">
<span class="sig-name descname"><span class="pre">change_bond_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moved_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.change_bond_length" title="Link to this definition"></a></dt>
<dd><p>Modify the selected bond length by distance length
along the current bond vector</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.change_bond_lengths">
<span class="sig-name descname"><span class="pre">change_bond_lengths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bonds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_network</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.change_bond_lengths" title="Link to this definition"></a></dt>
<dd><p>Given a list of bonds change their bond lengths by step</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.change_dihedral_angles">
<span class="sig-name descname"><span class="pre">change_dihedral_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_dihedrals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_network</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.change_dihedral_angles" title="Link to this definition"></a></dt>
<dd><p>Update a list of dihedrals by angles specified in step</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.get_bond_angle_info">
<span class="sig-name descname"><span class="pre">get_bond_angle_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.get_bond_angle_info" title="Link to this definition"></a></dt>
<dd><p>Given the current Cartesian coordinates of the atoms in
self.position compute all dihedrals, angles and bond lengths
needed to define the molecular configuration</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.get_bonds">
<span class="sig-name descname"><span class="pre">get_bonds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Graph</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.get_bonds" title="Link to this definition"></a></dt>
<dd><p>Find the current bonding framework for self.position</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.get_connected_atoms">
<span class="sig-name descname"><span class="pre">get_connected_atoms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.get_connected_atoms" title="Link to this definition"></a></dt>
<dd><p>Get the connected atom labels of each atom in molecule</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.get_movable_atoms">
<span class="sig-name descname"><span class="pre">get_movable_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_network</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.get_movable_atoms" title="Link to this definition"></a></dt>
<dd><p>For a given dihedral return the atoms that should be rotated</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.get_planar_rings">
<span class="sig-name descname"><span class="pre">get_planar_rings</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.get_planar_rings" title="Link to this definition"></a></dt>
<dd><p>Find the atoms that belong to a planar ring in the molecule</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.get_repeat_dihedrals">
<span class="sig-name descname"><span class="pre">get_repeat_dihedrals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dihedrals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.get_repeat_dihedrals" title="Link to this definition"></a></dt>
<dd><p>Only retain one dihedral when multiple share the same
central bond. Returns a list of repeats to remove</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.get_rotatable_dihedrals">
<span class="sig-name descname"><span class="pre">get_rotatable_dihedrals</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.get_rotatable_dihedrals" title="Link to this definition"></a></dt>
<dd><p>Find all the dihedral angles we can rotate about,
along with the atoms that should be rotated for each</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.get_rotation_matrix">
<span class="sig-name descname"><span class="pre">get_rotation_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">NDArray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.get_rotation_matrix" title="Link to this definition"></a></dt>
<dd><p>Generate rotation matrix for rotation about x axis</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.get_specific_bond_angle_info">
<span class="sig-name descname"><span class="pre">get_specific_bond_angle_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bonds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dihedrals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permutation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">NDArray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.get_specific_bond_angle_info" title="Link to this definition"></a></dt>
<dd><p>Find the bond lengths, bond angles and bond dihedrals for those
specified in the input lists, accounting for the permutation of
atoms according to permutation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.remove_atom_clashes">
<span class="sig-name descname"><span class="pre">remove_atom_clashes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">type</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.remove_atom_clashes" title="Link to this definition"></a></dt>
<dd><p>Check for clashes between atoms. Any atom pairs closer than
0.8*natural_cutoffs can cause a failure for electronic structure
calculations so locally minimise to remove clashes with stable
empirical force field</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.remove_repeat_angles">
<span class="sig-name descname"><span class="pre">remove_repeat_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.remove_repeat_angles" title="Link to this definition"></a></dt>
<dd><p>To change between conformations we can remove one angle
centered on each atom as it is specified by the rest</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.rotate_angle">
<span class="sig-name descname"><span class="pre">rotate_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angle_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moved_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.rotate_angle" title="Link to this definition"></a></dt>
<dd><p>Rotate one of the bonds in order to change the angle
between the two bonds defined by atom0-atom1 and
atom1-atom2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.rotate_dihedral">
<span class="sig-name descname"><span class="pre">rotate_dihedral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moved_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.rotate_dihedral" title="Link to this definition"></a></dt>
<dd><p>Perform rotation about central bond to change dihedral angle
defined between four consecutive atoms</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.MolecularCoordinates.same_bonds">
<span class="sig-name descname"><span class="pre">same_bonds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.MolecularCoordinates.same_bonds" title="Link to this definition"></a></dt>
<dd><p>Compares the bonding framework of the current coordinates
with the initial coordinates (self.reference_bonds)</p>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="topsearch.data.coordinates.StandardCoordinates">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">topsearch.data.coordinates.</span></span><span class="sig-name descname"><span class="pre">StandardCoordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topsearch.data.coordinates.StandardCoordinates" title="Link to this definition"></a></dt>
<dd><section id="id2">
<h2>Description<a class="headerlink" href="#id2" title="Link to this heading"></a></h2>
<p>Class to store a position in space, and the methods to
analyse if at bounds</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="topsearch.data.coordinates.StandardCoordinates.bounds">
<span class="sig-name descname"><span class="pre">bounds</span></span><a class="headerlink" href="#topsearch.data.coordinates.StandardCoordinates.bounds" title="Link to this definition"></a></dt>
<dd><p>The allowed ranges of the coordinates in each dimension</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of tuples [(b1_min, b1_max), (b2_min, b2_max)…]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="topsearch.data.coordinates.StandardCoordinates.ndim">
<span class="sig-name descname"><span class="pre">ndim</span></span><a class="headerlink" href="#topsearch.data.coordinates.StandardCoordinates.ndim" title="Link to this definition"></a></dt>
<dd><p>The dimensionality of the coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="topsearch.data.coordinates.StandardCoordinates.position">
<span class="sig-name descname"><span class="pre">position</span></span><a class="headerlink" href="#topsearch.data.coordinates.StandardCoordinates.position" title="Link to this definition"></a></dt>
<dd><p>Array of size ndim containing the current position</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.StandardCoordinates.active_bounds">
<span class="sig-name descname"><span class="pre">active_bounds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">NDArray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#topsearch.data.coordinates.StandardCoordinates.active_bounds" title="Link to this definition"></a></dt>
<dd><p>Checks whether the position is at the upper or lower bounds</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.StandardCoordinates.all_bounds">
<span class="sig-name descname"><span class="pre">all_bounds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.StandardCoordinates.all_bounds" title="Link to this definition"></a></dt>
<dd><p>Check if the position is at the bounds in all dimensions</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.StandardCoordinates.at_bounds">
<span class="sig-name descname"><span class="pre">at_bounds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#topsearch.data.coordinates.StandardCoordinates.at_bounds" title="Link to this definition"></a></dt>
<dd><p>Check if the position is at the bounds in any dimension</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.StandardCoordinates.check_bounds">
<span class="sig-name descname"><span class="pre">check_bounds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">NDArray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#topsearch.data.coordinates.StandardCoordinates.check_bounds" title="Link to this definition"></a></dt>
<dd><p>Check if position is at the bounds. Returns boolean
array denoting which dimensions are at the bounds</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.StandardCoordinates.generate_random_point">
<span class="sig-name descname"><span class="pre">generate_random_point</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">NDArray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#topsearch.data.coordinates.StandardCoordinates.generate_random_point" title="Link to this definition"></a></dt>
<dd><p>Return an random point within the bound ranges</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topsearch.data.coordinates.StandardCoordinates.move_to_bounds">
<span class="sig-name descname"><span class="pre">move_to_bounds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#topsearch.data.coordinates.StandardCoordinates.move_to_bounds" title="Link to this definition"></a></dt>
<dd><p>Move the coordinates to within the bounds if currently outside</p>
</dd></dl>

</section>
</dd></dl>

</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Luke Dicks.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>